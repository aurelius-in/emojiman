<!DOCTYPE html>
<html>
<head>
  <title>Pac-Man</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <style>
    canvas {
      border: 0px;
    }
    body {
      margin: 0;
      padding: 0;
      touch-action: manipulation; /* Prevent default zoom */
    }
  </style>
</head>
<body>

<canvas id="gameCanvas" width="270" height="600"></canvas>

<script>
  const canvas = document.getElementById('gameCanvas');
  const ctx = canvas.getContext('2d');

  let pacmanX = 25;
  let pacmanY = 25;
  let pacmanRadius = 12.5;
  let pacmanSpeed = 5;
  let angle = 0;
  let direction = 'right';

  // Maze layout (1 is wall, 0 is empty)
  const maze = [
    '1111111111',
    '1000000001',
    '1011111101',
    '1010000101',
    '1010110101',
    '1000110001',
    '1010110101',
    '1010000101',
    '1011111101',
    '1000000001',
    '1111111111'
  ];

  // Event listener for swipe controls
  let touchstartX = 0;
  let touchstartY = 0;
  let touchendX = 0;
  let touchendY = 0;

  canvas.addEventListener('touchstart', function(event) {
    event.preventDefault();
    touchstartX = event.changedTouches[0].screenX;
    touchstartY = event.changedTouches[0].screenY;
  }, false);

  canvas.addEventListener('touchend', function(event) {
    event.preventDefault();
    touchendX = event.changedTouches[0].screenX;
    touchendY = event.changedTouches[0].screenY;
    handleGesture();
  }, false);

  function handleGesture() {
    const dx = touchendX - touchstartX;
    const dy = touchendY - touchstartY;

    if (Math.abs(dx) > Math.abs(dy)) {
      direction = dx > 0 ? 'right' : 'left';
    } else {
      direction = dy > 0 ? 'down' : 'up';
    }
  }

  // Main game loop
  function gameLoop() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // Draw maze
    for (let y = 0; y < maze.length; y++) {
      for (let x = 0; x < maze[y].length; x++) {
        if (maze[y][x] === '1') {
          ctx.fillStyle = '#0000FF';
          ctx.fillRect(x * 27, y * 54.5, 27, 54.5);
        }
      }
    }

    // Draw Pac-Man
    ctx.fillStyle = '#FFFF00';
    ctx.beginPath();
    ctx.moveTo(pacmanX, pacmanY);
    ctx.arc(pacmanX, pacmanY, pacmanRadius, angle, angle + Math.PI * 1.8);
    ctx.lineTo(pacmanX, pacmanY);
    ctx.fill();

    // Update Pac-Man position
    if (direction === 'up') pacmanY -= pacmanSpeed;
    if (direction === 'down') pacmanY += pacmanSpeed;
    if (direction === 'left') pacmanX -= pacmanSpeed;
    if (direction === 'right') pacmanX += pacmanSpeed;

    // Update angle for Pac-Man's mouth
    angle += 0.1;
    if (angle > Math.PI / 4) angle = 0;

    requestAnimationFrame(gameLoop);
  }

  gameLoop();
</script>

</body>
</html>
